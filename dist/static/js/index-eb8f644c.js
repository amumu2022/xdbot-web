import{d as W,t as X,k as d,r as c,b as Y,o as b,c as w,i as Z,j as n,e as t,f as e,aG as ee,h as m,B,w as te,g as V,z as oe,ay as k,aI as ne,ae,_ as le}from"./index-6f723797.js";import{useRole as re}from"./hook-6b01546f.js";import{P as ie}from"./index-62542beb.js";import{u as r}from"./hooks-ea9aeb9a.js";import{R as se,c as ce}from"./dock-ec7e72b8.js";import me from"./formPrimitive-e2249ec1.js";import{f as pe}from"./caret-bottom-29c97c31.js";import{f as ue}from"./caret-top-26fff531.js";import{D as de}from"./delete-6d738bc7.js";import{E as fe}from"./edit-pen-af58ba35.js";import{d as _e}from"./search-cc37b371.js";import{R as ge}from"./refresh-74425c09.js";import{A as ve}from"./add-circle-line-438b436c.js";import{d as Ce,a as he}from"./checkbox-circle-line-ed36674b.js";import"./form-bcd7f46f.js";import"./index-80faaafb.js";import"./useBasicLayout-67c5ef4f.js";import"./xdteam-1bd5232c.js";import"./epTheme-99efc16e.js";const ye={class:"main"},be={key:0,class:"bg-[var(--el-fill-color-light)] w-full h-[46px] mb-2 pl-4 flex items-center"},ke={class:"flex-auto"},xe={style:{"font-size":"var(--el-font-size-base)"},class:"text-[rgba(42,46,54,0.5)] dark:text-[rgba(220,220,242,0.5)]"},$e=W({name:"FeaturesScript",__name:"index",setup(Se){X(()=>{p.value=!D.value});function z(){p.value=!p.value}const p=d(!1),x=d(),$=d();function N(f){se(f).then(async o=>{if(o.code!==200)return k(`操作失败，${o.message}`,{type:"error"}),"";k("运行成功",{type:"success"})})}const g=d(""),E=d(g.value);function F(f){ce(f).then(o=>{if(o.code!==200)return k(`操作失败，${o.message}`,{type:"error"}),"";{const i=JSON.parse(o.data),_=`## 开始执行... ${i.begin_time}`,a=`${i.log}`,h=`## 执行结束... ${i.end_time}  耗时：${i.use_time}秒`;ne({title:"日志详情",width:"46%",draggable:!0,fullscreenIcon:!0,fullscreen:!!D.value,contentRenderer:()=>ae(me,{data:`${_}

${a}
${h}`,"onUpdate:data":u=>g.value=u}),closeCallBack:()=>{g.value=E.value}})}})}const{form:v,loading:S,columns:I,dataList:T,selectedNum:R,pagination:A,onSearch:C,exportExcel:K,resetForm:L,openDialog:P,handleDelete:M,onbatchDel:O,isMobile:D,onSelectionCancel:U,handleSizeChange:j,handleCurrentChange:G,handleSelectionChange:J}=re($);return(f,o)=>{const i=c("el-input"),_=c("el-form-item"),a=c("el-button"),h=c("el-form"),u=c("el-popconfirm"),q=c("pure-table"),H=Y("motion-fade");return b(),w("div",ye,[p.value?(b(),Z(h,{key:0,ref_key:"formRef",ref:x,inline:!0,model:e(v),class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]"},{default:n(()=>[t(_,{label:"脚本名称：",prop:"name"},{default:n(()=>[t(i,{modelValue:e(v).name,"onUpdate:modelValue":o[0]||(o[0]=l=>e(v).name=l),placeholder:"请输入脚本名称",clearable:"",class:"!w-[160px]",onKeyup:o[1]||(o[1]=ee(l=>e(C)(),["enter"]))},null,8,["modelValue"])]),_:1}),t(_,null,{default:n(()=>[t(a,{type:"primary",icon:e(r)(e(_e)),loading:e(S),onClick:e(C)},{default:n(()=>[m(" 搜索 ")]),_:1},8,["icon","loading","onClick"]),t(a,{icon:e(r)(e(ge)),onClick:o[2]||(o[2]=l=>e(L)(x.value))},{default:n(()=>[m(" 重置 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])):B("",!0),t(e(ie),{title:"脚本列表",columns:e(I),onRefresh:e(C)},{buttons:n(()=>[t(a,{type:"primary",icon:e(r)(e(ve)),onClick:o[3]||(o[3]=l=>e(P)())},{default:n(()=>[m(" 新增脚本 ")]),_:1},8,["icon"]),t(a,{type:"success",onClick:e(K)},{default:n(()=>[m("导出")]),_:1},8,["onClick"]),t(a,{onClick:z,icon:p.value?e(r)(e(ue)):e(r)(e(pe))},null,8,["icon"])]),default:n(({size:l,dynamicColumns:Q})=>[e(R)>0?te((b(),w("div",be,[V("div",ke,[V("span",xe," 已选 "+oe(e(R))+" 项 ",1),t(a,{type:"primary",text:"",onClick:e(U)},{default:n(()=>[m(" 取消选择 ")]),_:1},8,["onClick"])]),t(u,{title:"是否确认删除?",onConfirm:e(O)},{reference:n(()=>[t(a,{type:"danger",text:"",class:"mr-1"},{default:n(()=>[m(" 批量删除 ")]),_:1})]),_:1},8,["onConfirm"])])),[[H]]):B("",!0),t(q,{"row-key":"id",ref_key:"tableRef",ref:$,adaptive:"",stripe:"","align-whole":"center",showOverflowTooltip:"","table-layout":"auto",loading:e(S),size:l,data:e(T),columns:Q,pagination:e(A),paginationSmall:l==="small","header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onSelectionChange:e(J),onPageSizeChange:e(j),onPageCurrentChange:e(G)},{operation:n(({row:s})=>[t(a,{class:"reset-margin",circle:"",type:"primary",size:l,icon:e(r)(e(fe)),onClick:y=>e(P)("编辑",s)},null,8,["size","icon","onClick"]),t(u,{title:`是否确认运行脚本：${s.name}`,onConfirm:y=>N(s.name)},{reference:n(()=>[t(a,{class:"reset-margin",circle:"",type:"success",size:l,icon:e(r)(e(Ce))},null,8,["size","icon"])]),_:2},1032,["title","onConfirm"]),t(a,{class:"reset-margin",circle:"",type:"primary",size:l,icon:e(r)(e(he)),onClick:y=>F(s.name)},null,8,["size","icon","onClick"]),t(u,{title:`是否确认删除脚本编号为${s.id}的这条数据`,onConfirm:y=>e(M)(s)},{reference:n(()=>[t(a,{class:"reset-margin",circle:"",type:"danger",size:l,icon:e(r)(e(de))},null,8,["size","icon"])]),_:2},1032,["title","onConfirm"])]),_:2},1032,["loading","size","data","columns","pagination","paginationSmall","header-cell-style","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"])])}}});const Ge=le($e,[["__scopeId","data-v-387be349"]]);export{Ge as default};
