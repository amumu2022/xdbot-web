import{d as ie,bi as re,k as g,t as de,r as d,o as s,c as b,e as a,j as c,f as p,i as I,O as me,g as u,h as K,bk as _e,B as V,F as C,v as j,bl as pe,z as h,bm as ve,x as A,b8 as J,bn as fe,bo as be,aG as ge,U as he,bp as ye,W as v,ay as L,aI as we,aJ as ke,bq as De}from"./index-6f723797.js";import{_ as xe}from"./form.vue_vue_type_script_setup_true_lang-d41c67f9.js";import{c as Ie}from"./chatgpt-icon-09e07282.js";import{u as Ce}from"./useBasicLayout-67c5ef4f.js";import{E as Me}from"./md-editor-v3.es-57b70782.js";/* empty css              */const Ne={style:{display:"flex","justify-content":"center","align-items":"center"}},Se=u("span",null,"XD 聊天沙盒",-1),Ve={style:{color:"rgb(30, 206, 88)"}},Le={class:"chat-content"},Ue={key:0,class:"word"},Be=["src"],$e={class:"info"},je={class:"time"},Oe={key:0,class:"text-message"},Xe={key:2,controls:"",width:"300",class:"video-message"},Ee=["src"],qe={key:3,class:"audio-container"},ze={controls:"",class:"aud",style:{outline:"none"}},Fe=["src"],Ke={key:4,class:"audio-container"},Ae={key:1,class:"word-my"},Je={class:"info"},Re={class:"time"},Te=["src"],et=ie({__name:"index",setup(Ge){const{clipboardValue:R,copied:T}=re(),l=g({chatID:void 0,bubble1:"#a3c3f6",bubble2:"#fff"}),{isMobile:y}=Ce(),M=g(!0),k=g(""),D=g(""),x=g([]),m=g(""),O=g(!1),o=g({}),r=g([{mineMsg:!1,nickName:"小管家",headUrl:"",time:new Date().toLocaleString(),messages:[{type:"text",content:`你好，我是小艾格，现在时间是${new Date().toLocaleString()}`}]}]);function U(){o.value=v().getItem("chatData");const t=o.value;return Object.keys(t).map(n=>({text:`${t[n].name}`,id:n}))}function N(){v().setItem("XDchat",{bubble1:l.value.bubble1,bubble2:l.value.bubble2,chatID:m.value})}function G(){o.value=v().getItem("chatData");const t=o.value,e=Object.keys(t),n=Math.floor(Math.random()*e.length),_=e[n];if(_){m.value=_;const w=o.value[_];r.value=w.message,N()}else S()}function P(){var t,e,n;if((t=v().getItem("XDchat"))!=null&&t.bubble1&&(l.value=v().getItem("XDchat")),v().getItem("chatData")&&(x.value=U()),y.value?O.value=!0:M.value=!1,!((e=v().getItem("XDchat"))!=null&&e.chatID))S();else{m.value=(n=v().getItem("XDchat"))==null?void 0:n.chatID;const _=o.value[m.value];_?r.value=_.message:S()}}async function X(){const t=k.value.trim();if(t){const e={mineMsg:!0,headUrl:"http://q.qlogo.cn/headimg_dl?dst_uin=651380741&spec=640&img_type=jpg",nickName:"我",time:new Date().toLocaleString(),content:k.value};r.value.push(e),k.value="";const n={message:t},_=await SendMessage(n);if(_.success)r.value.push(_.data);else{const w=["哎呀，这个关键词好像不在我的词典里呢，换一个试试吧？","看来这个词是个小众选择呢，我这里找不到相关的信息哦。","呜呜，这个关键词藏得有点深，我搜寻不到呢。","嘿，这个关键词好神秘，就像未知星球一样，我这里探测不到信号呀。","这个关键词似乎和我擦肩而过了，要不要试试别的词汇呢？","嗯哼，这个关键词好像走丢了，我帮你找找其他的吧？","这个关键词太低调了，连我都没注意到它，换一个更醒目的吧。","哦豁，这个关键词没找到，我们换个话题如何？","你的关键词好像是个隐形的小可爱，我这里暂时看不到它呢。","对不起呀，这个关键词我不太懂，让我们一起探索新的知识领域吧。","唔，这个关键词好像不在我的数据库里，试试其他的关键词怎么样？","这个关键词好像在捉迷藏，我找不到它的踪迹呢。","这个关键词太害羞了，躲起来不见人了，我们换一个吧。","这个词儿有点高冷，不太愿意出现在我的视线里呢。","哎呀，没能找到你说的这个关键词，是不是打错字啦？","看来这个关键词跟我不太熟，介绍一下别的吧？","这个关键词好像不想和我玩，我们换个玩伴吧。","这个关键词像小星星一样遥不可及，给我一些更接地气的词吧","噢，这个关键词有点神秘，似乎超出了我的知识范围呢。","这个关键词好像不在服务区，我们是不是得换个话题呢？"],$={mineMsg:!1,nickName:"小管家",headUrl:"",time:new Date().toLocaleString(),messages:[{type:"text",content:w[Math.floor(Math.random()*w.length)]}]};r.value.push($)}o.value[m.value].name==="New Chat"?(o.value[m.value].name=t.substring(0,4),v().setItem("chatData",o.value),x.value=U(),o.value[m.value].message=r.value):(o.value[m.value].message=r.value,v().setItem("chatData",o.value))}}function W(){r.value=[{mineMsg:!1,nickName:"小管家",headUrl:"",time:new Date().toLocaleString(),messages:[{type:"text",content:`你好，我是小艾格，现在时间是${new Date().toLocaleString()}`}]}],o.value[m.value].message=r.value,v().setItem("chatData",o.value),L("聊天记录已清空",{type:"warning"})}function H(){delete o.value[m.value],v().setItem("chatData",o.value),x.value=U(),L("对话已删除",{type:"warning"}),G()}const Q=()=>{R.value=JSON.stringify(r.value),T.value&&L("聊天记录已复制",{type:"success"})};function B(){y.value=!y.value,M.value=!M.value}function Y(){we({width:"46%",draggable:!0,fullscreenIcon:!0,fullscreen:!!y.value,title:"参数调整",contentRenderer:()=>xe,props:{formInline:{platform:l.value.platform,type:l.value.type,group_id:l.value.group_id,bubble1:l.value.bubble1,bubble2:l.value.bubble2}},footerButtons:[{label:"确认",type:"success",btnClick:({dialog:{options:t,index:e}})=>{ke(t,e)}}],closeCallBack:({options:t})=>{const{formInline:e}=t.props;l.value.bubble1=e.bubble1,l.value.bubble2=e.bubble2,l.value.group_id=e.group_id,l.value.platform=e.platform,l.value.type=e.type,l.value.platform==1?D.value="自定义API":l.value.platform==2?D.value="问答模式":l.value.platform==3&&(D.value="函数执行"),L(`当前模式为 ${D.value}`,{type:"success"}),N()}})}const Z=t=>{const e=t.id;m.value=e;const n=o.value[e];r.value=n.message,N(),O.value&&B()},S=()=>{const t=De();m.value=t,N();const e={text:"New Chat",id:t};x.value.push(e),r.value=[{mineMsg:!1,nickName:"小管家",headUrl:"",time:new Date().toLocaleString(),messages:[{type:"text",content:`你好，我是小艾格，现在时间是${new Date().toLocaleString()}`}]}];const n={[t]:{name:"New Chat",message:r.value}},_=Object.assign(o.value,n);v().setItem("chatData",_)};return de(()=>{P()}),(t,e)=>{const n=d("el-button"),_=d("el-icon"),w=d("el-menu-item"),$=d("el-menu"),E=d("el-col"),ee=d("el-aside"),te=d("el-header"),ne=d("el-image"),ae=d("el-main"),le=d("el-popconfirm"),q=d("el-row"),oe=d("el-input"),se=d("el-footer"),z=d("el-container");return s(),b(C,null,[a(z,null,{default:c(()=>[p(y)?V("",!0):(s(),I(ee,{key:0,class:me([M.value?"mobile":"pc"])},{default:c(()=>[u("div",Ne,[a(n,{class:"new_chat",onClick:S},{default:c(()=>[K(" + 新增 ")]),_:1}),p(y)?V("",!0):(s(),I(n,{key:0,icon:p(_e),onClick:B,style:{float:"right",border:"none",outline:"none","background-color":"transparent","margin-right":"10px"}},null,8,["icon"]))]),a(E,null,{default:c(()=>[a($,{"active-text-color":"#4b9e5f","default-active":m.value,style:{"background-color":"transparent"}},{default:c(()=>[(s(!0),b(C,null,j(x.value,i=>(s(),I(w,{key:i.id,index:i.id.toString(),class:"menu-item-background",onClick:F=>Z(i)},{default:c(()=>[a(_,null,{default:c(()=>[a(p(pe))]),_:1}),u("span",null,h(i.text),1)]),_:2},1032,["index","onClick"]))),128))]),_:1},8,["default-active"])]),_:1})]),_:1},8,["class"])),a(z,{style:{height:"85vh",display:"flex","flex-direction":"column"}},{default:c(()=>[a(te,{style:{"margin-top":"20px"}},{default:c(()=>[p(y)?(s(),I(n,{key:0,icon:p(ve),onClick:B,style:{float:"right",border:"none",outline:"none","background-color":"transparent"}},null,8,["icon"])):V("",!0),Se,u("span",Ve,h(D.value),1)]),_:1}),a(ae,null,{default:c(()=>[u("div",Le,[(s(!0),b(C,null,j(r.value,(i,F)=>(s(),b("div",{key:F},[i.mineMsg?(s(),b("div",Ae,[u("div",Je,[u("p",Re,h(i.nickName)+" "+h(i.time),1),u("div",{class:"info-content bubble",style:A({background:l.value.bubble1})},h(i.content),5)]),u("img",{class:"avatar",src:i.headUrl},null,8,Te)])):(s(),b("div",Ue,[u("img",{class:"avatar",src:p(Ie)},null,8,Be),u("div",$e,[u("p",je,h(i.nickName)+" "+h(i.time),1),u("div",{class:"info-content bubble",style:A({background:l.value.bubble2})},[(s(!0),b(C,null,j(i.messages,(f,ce)=>(s(),b(C,{key:ce},[f.type==="text"?(s(),b("div",Oe,h(f.content),1)):f.type==="image"?(s(),I(ne,{key:1,class:"chat-image",src:f.content,"preview-src-list":[f.content]},null,8,["src","preview-src-list"])):f.type==="video"?(s(),b("video",Xe,[u("source",{src:f.content,type:"video/mp4"},null,8,Ee)])):f.type==="audio"?(s(),b("div",qe,[u("audio",ze,[u("source",{src:f.content,type:"audio/mpeg"},null,8,Fe)])])):f.type==="chatgpt"?(s(),b("div",Ke,[a(p(Me),{modelValue:f.content,"onUpdate:modelValue":ue=>f.content=ue,"preview-only":"",showCodeRowNumber:""},null,8,["modelValue","onUpdate:modelValue"])])):V("",!0)],64))),128))],4)])]))]))),128))])]),_:1}),a(se,{height:"150px"},{default:c(()=>[a(q,{class:"low-row",style:{width:"100%"}},{default:c(()=>[a(E,{span:24},{default:c(()=>[a(q,null,{default:c(()=>[a(n,{type:"success",icon:p(J),circle:""},null,8,["icon"]),a(n,{type:"info",icon:p(J),circle:"",onClick:Y},null,8,["icon"]),a(n,{type:"primary",icon:p(fe),circle:"",onClick:Q},null,8,["icon"]),a(le,{title:"是否删除对话?",onConfirm:H,onCancel:W,"confirm-button-type":"danger","cancel-button-type":"warning"},{reference:c(()=>[a(n,{type:"danger",icon:p(be),circle:""},null,8,["icon"])]),_:1})]),_:1})]),_:1}),a(oe,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=i=>k.value=i),class:"chat-input",rows:4,type:"textarea",placeholder:"请输入内容...",onKeydown:ge(he(X,["ctrl"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),a(n,{type:"success",icon:p(ye),onClick:X,class:"send-button-fixed"},{default:c(()=>[K("发送")]),_:1},8,["icon"])],64)}}});export{et as default};
