import{Y as m,k as p,t as _,e as r,r as h,ar as w,ay as i,aH as v,aI as Y,ae as j,M as b,aJ as E,aK as I}from"./index-6f723797.js";import{a as O,b as $,c as B}from"./monitor-98a23e5d.js";import{_ as H}from"./description.vue_vue_type_style_index_0_lang-d77bb804.js";import{u as L}from"./useBasicLayout-67c5ef4f.js";import{E as N}from"./xdteam-1bd5232c.js";const{isMobile:x}=L();function F(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!I(o)}function U(o){const l=m({uid:"",status:"",operation:"",module:"",currentPage:1,pageSize:10}),y=[{value:0,text:"其他"},{value:1,text:"修改"},{value:2,text:"添加"},{value:3,text:"删除"},{value:4,text:"登录"},{value:5,text:"上传"}],s=p([]),c=p(!0),u=p(0),g=m({total:0,pageSize:10,currentPage:1,pageSizes:[10,20,50,100],background:!0}),S=e=>(l.currentPage-1)*l.pageSize+e+1,z=()=>{N(s,f)},f=[{label:"列表",type:"selection"},{label:"序号",type:"index",index:S,minWidth:50},{label:"编号",hide:!0,prop:"id"},{label:"业务模块",prop:"module",minWidth:160,cellRenderer:({row:e})=>r("span",{style:{color:"blue"}},[e.module])},{label:"用户",prop:"uid",minWidth:100},{label:"操作类型",prop:"operation",minWidth:100,cellRenderer:({row:e,props:t})=>{const a=[{value:0,text:""},{value:1,text:null},{value:2,text:"warning"},{value:3,text:"danger"},{value:4,text:"success"},{value:5,text:"info"}],d=y[e.operation].text,k=a[e.operation].text;return r(h("el-tag"),{size:t.size,type:k,effect:"dark"},F(d)?d:{default:()=>[d]})}},{label:"请求方式",prop:"method",minWidth:100,cellRenderer:({row:e})=>{let t="",a="";return a=e.request_params.method,a=="GET"?t="green":a=="POST"?t="#e6a23c":a=="PUT"?t="blue":t="red",r("span",{style:{color:t}},[a])}},{label:"IP地址",prop:"ip",minWidth:100},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:e,props:t})=>r(h("el-tag"),{size:t.size,type:e.status===0?"danger":"success",effect:"dark"},{default:()=>[e.status===0?"失败":"成功"]})},{label:"访问时间",minWidth:180,prop:"create_time",formatter:({create_time:e})=>w(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:110,slot:"operation"}];function T(e){O(e.id).then(async t=>{t.code===200?(i(`您删除了日志ID为${e.id}的这条数据`,{type:"success"}),await n()):i(`操作失败，${t.message}`,{type:"error"})})}function D(e){u.value=e.length,o.value.setAdaptive()}function C(){u.value=0,o.value.getTableRef().clearSelection()}function P(){const e=o.value.getTableRef().getSelectionRows();$(v(e,"id")).then(async t=>{t.code===200?(i(`已删除日志编号为 ${v(e,"id")} 的数据`,{type:"success"}),await n()):i(`操作失败，${t.message}`,{type:"error"}),o.value.getTableRef().clearSelection()})}function R(e){l.currentPage=1,l.pageSize=e,n()}function W(e){l.currentPage=e,n()}function A(e){Y({title:"日志详情",width:"60%",draggable:!0,fullscreen:!!x.value,fullscreenIcon:!0,closeOnClickModal:!0,contentRenderer:()=>j(H,b(e)),footerButtons:[{label:"关闭",text:!0,size:"large",bg:!0,btnClick:({dialog:{options:t,index:a}})=>{E(t,a)}}]})}async function n(){c.value=!0;const{data:e}=await B(b(l));s.value=e.results,g.total=e.total,setTimeout(()=>{c.value=!1},500)}const M=e=>{e&&(e.resetFields(),n())};return _(()=>{n()}),{form:l,loading:c,columns:f,dataList:s,selectedNum:u,pagination:g,isMobile:x,onbatchDel:P,openDialog:A,onSearch:n,exportExcel:z,resetForm:M,handleDelete:T,onSelectionCancel:C,handleSizeChange:R,handleCurrentChange:W,handleSelectionChange:D}}export{U as useRole};
