import{$ as y,k as h,t as j,e as S,r as T,S as d,aI as z,aJ as A,ag as E,N as w,aK as I,aw as B}from"./index-9cea40a6.js";import{k as F,l as L,n as V}from"./main-cbd39795.js";import{_ as J}from"./description.vue_vue_type_style_index_0_lang-5f22ab28.js";import{E as K}from"./xdteam-5bf4004a.js";import{u as q}from"./useBasicLayout-7ee1042a.js";function D(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!B(a)}const{isMobile:C}=q();function Z(a){const n=y({name:"",user:"",time:"",result:"",msg:"",method:"",border:"",currentPage:1,pageSize:10}),p=h([]),g=h(!0),f=h(0),x=y({total:0,pageSize:10,currentPage:1,pageSizes:[10,20,50,100],background:!0}),W=e=>(n.currentPage-1)*n.pageSize+e+1,k=()=>{K(p,b)},b=[{label:"列表",type:"selection"},{label:"序号",type:"index",index:W,minWidth:50},{label:"编号",hide:!0,prop:"id"},{label:"商品名称",prop:"name",minWidth:100},{label:"商品ID",prop:"num",minWidth:60},{label:"终端用户",prop:"user",minWidth:100},{label:"商品信息",prop:"msg",minWidth:200,align:"left"},{label:"支付方式",prop:"method",minWidth:100,cellRenderer:({row:e,props:t})=>{var u,c;const s=[{value:"货币兑换",text:"货币兑换"},{value:"支付宝支付",text:"支付宝支付"},{value:"微信支付",text:"微信支付"},{value:"QQ支付",text:"QQ支付"},{value:"余额支付",text:"余额支付"}],m=[{value:"货币兑换",text:"info"},{value:"支付宝支付",text:"warning"},{value:"微信支付",text:"danger"},{value:"QQ支付",text:"success"},{value:"余额支付",text:null}],i=e.method,v=(u=m.find(r=>r.value===i))==null?void 0:u.text,l=(c=s.find(r=>r.value===i))==null?void 0:c.text;return S(T("el-tag"),{size:t.size,type:v,effect:"dark"},D(l)?l:{default:()=>[l]})}},{label:"订单状态",prop:"result",minWidth:100,cellRenderer:({row:e,props:t})=>{var u,c;const s=[{value:"已完成",text:"已完成"},{value:"待支付",text:"待支付"},{value:"已超时",text:"已超时"}],m=[{value:"待支付",text:"warning"},{value:"已超时",text:"danger"},{value:"已完成",text:"success"}],i=e.result,v=(u=m.find(r=>r.value===i))==null?void 0:u.text,l=(c=s.find(r=>r.value===i))==null?void 0:c.text;return S(T("el-tag"),{size:t.size,type:v,effect:"dark"},D(l)?l:{default:()=>[l]})}},{label:"流水单号",prop:"border",minWidth:110},{label:"操作",fixed:"right",width:110,slot:"operation"}];function O(e){F(e.id).then(async t=>{t.code===200?(d(`您删除了订单ID为${e.id}的这条数据`,{type:"success"}),await o()):d(`操作失败，${t.message}`,{type:"error"})})}function Q(e){f.value=e.length,a.value.setAdaptive()}function R(){f.value=0,a.value.getTableRef().clearSelection()}function P(){const e=a.value.getTableRef().getSelectionRows();L(z(e,"id")).then(async t=>{t.code===200?(d(`已删除订单编号为 ${z(e,"id")} 的数据`,{type:"success"}),await o()):d(`操作失败，${t.message}`,{type:"error"}),a.value.getTableRef().clearSelection()})}function $(e){n.currentPage=1,n.pageSize=e,o()}function M(e){n.currentPage=e,o()}function N(e){A({title:"订单详情",width:"60%",draggable:!0,fullscreen:!!C.value,closeOnClickModal:!0,contentRenderer:()=>E(J,w(e)),footerButtons:[{label:"关闭",text:!0,size:"large",bg:!0,btnClick:({dialog:{options:t,index:s}})=>{I(t,s)}}]})}async function o(){g.value=!0;const{data:e}=await V(w(n));p.value=e.results,x.total=e.total,setTimeout(()=>{g.value=!1},500)}const _=e=>{e&&(e.resetFields(),o())};return j(()=>{o()}),{form:n,loading:g,columns:b,dataList:p,exportExcel:k,selectedNum:f,pagination:x,isMobile:C,onbatchDel:P,openDialog:N,onSearch:o,resetForm:_,handleDelete:O,onSelectionCancel:R,handleSizeChange:$,handleCurrentChange:M,handleSelectionChange:Q}}export{Z as useRole};
